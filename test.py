import ctypes

public_inputs = """0 1
2 1a4
3 aa4
4 48
5 10c6aec8c72bab7f2942aa9049a8b59ef2a80809bdc5b02df5d0e2db59742a31
6 44
15 ac
24 33
33 eb
42 86
51 d5
60 57
69 fe
78 50
87 2e
96 86
105 c0
114 dc
123 be
132 9b
141 94
150 22
159 dd
168 cb
177 d3
186 f9
195 6c
204 82
213 89
222 40
231 b
240 13
249 fa
258 14
267 b9
276 16
285 a
294 b
303 46
312 54
321 62
330 15
339 2c
348 d4
357 8a
366 ff
375 5e
384 36
393 1b
402 9c
411 12
420 fd
429 1e
438 a9
447 b8
456 8c
465 19
474 bb
483 55
492 ad
501 26
510 1a
519 d8
528 db
537 a8
546 e9
555 12
564 20
573 35
582 1a
591 ba
600 2c
609 dd
618 2a
627 ff
636 ad
645 e0
654 ca
663 53
672 b8
681 21
690 5c
699 9b
708 51
717 2c
726 1f
735 17
744 5b
753 47
762 64
771 43
780 46
789 75
798 8a
807 2c
816 2
825 ec
834 44
843 3f
852 33
861 a8
870 4f
879 dd
888 54
897 bb
906 85
915 8
924 6f
933 66
942 0
951 0
960 0
969 0
978 0
987 0
996 0
1005 0
1014 0
1023 0
1032 0
1041 0
1050 0
1059 0
1068 0
1077 0
1086 0
1095 0
1104 0
1113 0
1122 0
1131 0
1140 0
1149 0
1158 0
1167 0
1176 0
1185 0
1194 0
1203 0
1212 0
1221 0
1230 0
1239 0
1248 0
1257 0
1266 0
1275 0
1284 0
1293 0
1302 0
1311 0
1320 0
1329 0
1338 0
1347 0
1356 0
1365 0
1374 0
1383 0
1392 0
1401 0
1410 0
1419 0
1428 0
1437 0"""

def test_verify():
    lib = ctypes.CDLL('/home/collin/Desktop/Projects/zk-dns-filter/CodeSnippets/prover/jsnark/libsnark/build/libsnark/jsnark_interface/libpython_prove_r1cs_gg_ppzksnarkd.so')
    with open('/home/collin/Desktop/Projects/zk-dns-filter/CodeSnippets/prover/data/tmp_co_proof', 'rb') as f:
        r1cs_proof = f.read()
        pvk = lib.read_pvk(ctypes.c_char_p('/home/collin/Desktop/Projects/zk-dns-filter/CodeSnippets/prover/data/co_pvk'.encode()))
        ans = lib.verify_proof(ctypes.c_char_p(public_inputs.encode()), ctypes.c_char_p(r1cs_proof), len(r1cs_proof), pvk)
        print(ans)

def test_read():
    lib = ctypes.CDLL('/home/collin/Desktop/Projects/zk-dns-filter/CodeSnippets/prover/jsnark/libsnark/build/libsnark/jsnark_interface/libpython_prove_r1cs_gg_ppzksnarkd.so')
    with open('/home/collin/Desktop/Projects/zk-dns-filter/CodeSnippets/prover/data/tmp_co_proof', 'rb') as f:
        r1cs_proof = f.read()
        # print(r1cs_proof)
        # print("end")
        lib.read_proof(ctypes.c_char_p(r1cs_proof))

# test_read()
test_verify()